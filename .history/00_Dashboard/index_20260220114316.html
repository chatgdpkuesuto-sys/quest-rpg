<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MACHADUN - Ultimate Eroge TRPG Engine</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts: Shippori Mincho for a cinematic novel feel -->
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;500;700;800&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- 🌟 Browser Audio Autoplay Policy Button & Character Selection 🌟 -->
    <div id="init-overlay">
        <!-- Step 1: Stat Allocation -->
        <div class="init-dialog" id="stat-dialog">
            <h1 class="init-title">まちゃだん</h1>
            <p class="init-sub">- 主人公作成：能力値の割り振り -</p>
            <p class="init-hint">残りポイント: <span id="remaining-points">3</span></p>

            <div class="stat-grid">
                <div class="stat-row"><span>筋力</span> <button onclick="adjStat('power', -1)">-</button> <span
                        id="val-power">0</span> <button onclick="adjStat('power', 1)">+</button></div>
                <div class="stat-row"><span>敏捷</span> <button onclick="adjStat('speed', -1)">-</button> <span
                        id="val-speed">0</span> <button onclick="adjStat('speed', 1)">+</button></div>
                <div class="stat-row"><span>耐久</span> <button onclick="adjStat('tough', -1)">-</button> <span
                        id="val-tough">0</span> <button onclick="adjStat('tough', 1)">+</button></div>
                <div class="stat-row"><span>知性</span> <button onclick="adjStat('mind', -1)">-</button> <span
                        id="val-mind">0</span> <button onclick="adjStat('mind', 1)">+</button></div>
                <div class="stat-row"><span>魅力</span> <button onclick="adjStat('charm', -1)">-</button> <span
                        id="val-charm">0</span> <button onclick="adjStat('charm', 1)">+</button></div>
                <div class="stat-row"><span>技巧</span> <button onclick="adjStat('skill', -1)">-</button> <span
                        id="val-skill">0</span> <button onclick="adjStat('skill', 1)">+</button></div>
            </div>

            <button class="char-btn" style="margin-top: 20px; width: 100%;" onclick="confirmStats()">決定</button>
        </div>

        <!-- Step 2: Target Selection -->
        <div class="init-dialog" id="target-dialog" style="display: none;">
            <h1 class="init-title">まちゃだん</h1>
            <p class="init-sub">- 攻略対象を選択せよ -</p>
            <div class="char-select-grid">
                <button class="char-btn" onclick="startGame('Aria', 'アリア')">アリア</button>
                <button class="char-btn" onclick="startGame('Zena', 'ゼナ')">ゼナ</button>
                <button class="char-btn" onclick="startGame('Elara', 'エララ')">エララ</button>
                <button class="char-btn" onclick="startGame('Elize', 'エリーゼ')">エリーゼ</button>
                <button class="char-btn" onclick="startGame('Yuni', 'ユニ')">ユニ</button>
                <button class="char-btn" onclick="startGame('Mia', 'ミア')">ミア</button>
            </div>
            <button class="char-btn back-btn" style="margin-top: 20px; width: 100%; opacity: 0.7;"
                onclick="backToStats()">戻る</button>
            <p class="init-hint">※ クリックで音声が有効化され、シナリオが開始します。</p>
        </div>
    </div>

    <!-- 動的な背景CG/イラストコンテナ -->
    <div id="bg-container"></div>

    <!-- 狂気・発情エフェクト用オーバーレイ -->
    <div id="blood-overlay"></div>
    <div id="glitch-overlay"></div>

    <!-- 音声プレイヤー -->
    <audio id="voice-player" preload="none"></audio>

    <!-- UI レイヤー -->
    <div id="ui-layer">

        <!-- 左上：キャラクター情報＆ステータス簡易表示 -->
        <div id="character-info-panel">
            <h2 id="char-name">No Data</h2>
            <div id="char-attributes"></div>
        </div>

        <!-- 右上：ゲージ系装飾（侵食度、絶望度など） -->
        <div id="status-panel">
            <div class="status-bar-container">
                <span class="status-label">快感</span>
                <div class="progress-bar">
                    <div id="arousal-fill" class="progress-fill arousal"></div>
                </div>
            </div>
            <div class="status-bar-container">
                <span class="status-label">絶望</span>
                <div class="progress-bar">
                    <div id="despair-fill" class="progress-fill despair"></div>
                </div>
            </div>
        </div>

        <!-- 画面中央〜下部：シネマティックなモノローグ（GMテキスト） -->
        <div id="monologue-container">
            <!-- JavaScriptでテキストが流し込まれる -->
        </div>

        <!-- 画面下部：キャラクターのセリフ（ノベルゲーム風フルテキスト） -->
        <div id="dialogue-box">
            <div id="dialogue-name"></div>
            <div id="dialogue-text"></div>
        </div>

    </div>

    <!-- インタラクション層（クリック取得用、透明） -->
    <!-- ユーザーの要望通り、クリックで画像を変えず、状態を投げるだけに特化する -->
    <div id="interaction-layer"></div>

    <!-- スクリプト群 -->
    <script src="js/engine.js"></script>
    <script src="js/interaction.js"></script>
</body>

</html>